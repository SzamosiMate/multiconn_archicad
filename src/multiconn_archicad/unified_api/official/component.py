# This file is automatically generated by the build system.
# Do not edit this file directly.

from __future__ import annotations
from typing import TYPE_CHECKING

from multiconn_archicad.models.official.commands import (
    GetComponentsOfElementsParameters,
    GetComponentsOfElementsResult,
    GetPropertyValuesOfElementComponentsParameters,
    GetPropertyValuesOfElementComponentsResult,
)
from multiconn_archicad.models.official.types import (
    ElementComponentIdArrayItem,
    ElementIdArrayItem,
    PropertyIdArrayItem,
)

if TYPE_CHECKING:
    from multiconn_archicad.core.core_commands import CoreCommands


class ComponentCommands:
    def __init__(self, core: CoreCommands):
        self._core = core

    def get_components_of_elements(self, elements: list[ElementIdArrayItem]) -> GetComponentsOfElementsResult:
        """
        Returns the identifier of every component for a list of elements. The order of the
        returned list is the same as the given elements.

        Args:
            elements (list[ElementIdArrayItem]): A list of elements.

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
        """
        params_dict = {
            "elements": elements,
        }
        validated_params = GetComponentsOfElementsParameters(**params_dict)
        response_dict = self._core.post_command(
            "API.GetComponentsOfElements", validated_params.model_dump(by_alias=True, exclude_none=True)
        )
        return GetComponentsOfElementsResult.model_validate(response_dict)

    def get_property_values_of_element_components(
        self, element_components: list[ElementComponentIdArrayItem], properties: list[PropertyIdArrayItem]
    ) -> GetPropertyValuesOfElementComponentsResult:
        """
        Returns the property values of the components for the given property.

        Args:
            element_components (list[ElementComponentIdArrayItem]): List of components of
                elements.
            properties (list[PropertyIdArrayItem]): A list of property identifiers.

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
        """
        params_dict = {
            "elementComponents": element_components,
            "properties": properties,
        }
        validated_params = GetPropertyValuesOfElementComponentsParameters(**params_dict)
        response_dict = self._core.post_command(
            "API.GetPropertyValuesOfElementComponents", validated_params.model_dump(by_alias=True, exclude_none=True)
        )
        return GetPropertyValuesOfElementComponentsResult.model_validate(response_dict)
